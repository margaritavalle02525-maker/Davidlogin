<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ðŸŽ® Panel Admin | Recargar Saldo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#070b14;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif;
}
.container{
  max-width:520px;
  margin:auto;
  padding:20px;
}
h2{
  text-align:center;
  color:#00ffcc;
  margin-bottom:10px;
}

/* BUSCADOR */
.search-box{
  display:flex;
  align-items:center;
  gap:10px;
  background:#0b1220;
  padding:12px 14px;
  border-radius:14px;
  box-shadow:0 0 15px #00ffcc44;
  margin-bottom:16px;
}
.search-box svg{
  width:22px;
  height:22px;
  stroke:#00ffcc;
  fill:none;
  stroke-width:2;
}
.search-box input{
  flex:1;
  background:none;
  border:none;
  outline:none;
  color:#fff;
  font-size:14px;
}
.search-box input::placeholder{
  color:#6fffe6aa;
}

/* TARJETAS */
.card{
  background:#0e1627;
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
  box-shadow:0 0 15px #00ffcc22;
}
.user-item{
  background:#121c33;
  padding:12px;
  border-radius:12px;
  margin-top:10px;
  font-size:14px;
}
.user-item:hover{
  border:1px solid #00ffcc;
  box-shadow:0 0 10px #00ffcc66;
}

/* BOTONES */
.btns{
  display:flex;
  gap:8px;
  margin-top:10px;
}
button{
  flex:1;
  padding:10px;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}
.plus{background:#00ffcc;color:#000}
.minus{background:#ff4d4d;color:#000}
</style>
</head>

<body>
<div class="container">

<h2>ðŸ“¦ PANEL ADMIN â€” RECARGAR SALDO</h2>

<!-- BUSCADOR -->
<div class="search-box">
  <svg viewBox="0 0 24 24">
    <circle cx="11" cy="11" r="7"/>
    <line x1="16.5" y1="16.5" x2="22" y2="22"/>
  </svg>
  <input id="buscar" placeholder="Buscar correo / saldo / ID..." oninput="buscarUsuario()">
</div>

<div class="card">
  <div id="estado">Conectando a Firebase...</div>
</div>

<div id="lista"></div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, doc, updateDoc, increment }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ðŸ”¥ TU FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyAKrBTAkJGhB9s3E3MExqzj8mtXgKYsWRc",
  authDomain: "davidstore-51f7f.firebaseapp.com",
  projectId: "davidstore-51f7f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const estado = document.getElementById("estado");
const lista  = document.getElementById("lista");

/* ðŸ“¦ CARGAR USUARIOS */
const snap = await getDocs(collection(db,"login"));
estado.textContent = `Usuarios encontrados: ${snap.size}`;

snap.forEach(d=>{
  const data = d.data();
  lista.innerHTML += `
    <div class="user-item">
      ðŸ“§ <b>${data.email ?? "SIN EMAIL"}</b><br>
      ðŸ’° Saldo: <b>${data.saldo ?? 0}</b><br>
      ðŸ†” ${d.id}

      <div class="btns">
        <button class="plus" onclick="cambiarSaldo('${d.id}',10)">+10</button>
        <button class="minus" onclick="cambiarSaldo('${d.id}',-10)">-10</button>
      </div>
    </div>
  `;
});

/* ðŸ” BUSCAR */
window.buscarUsuario = ()=>{
  const txt = document.getElementById("buscar").value.toLowerCase();
  document.querySelectorAll(".user-item").forEach(i=>{
    i.style.display = i.innerText.toLowerCase().includes(txt)
      ? "block"
      : "none";
  });
};

/* ðŸ’° CAMBIAR SALDO */
window.cambiarSaldo = async (id, valor)=>{
  const ref = doc(db,"login",id);
  await updateDoc(ref,{ saldo: increment(valor) });
  location.reload();
};
</script>

</body>
</html>